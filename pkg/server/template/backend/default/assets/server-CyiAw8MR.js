import{q as h,_ as b,H as v,u as w,o as _,c as d,a as s,h as m,t,F as x,b as n,w as S,I as y,J as k,K as I,p as z,f as B,D as L}from"./index-Cl3ObPDm.js";/* empty css                 */import{h as P}from"./help-DoMWFVUl.js";import{M as E}from"./monitor-faults-D0n7GrUf.js";/* empty css                  */import"./server-03Z7m1hJ.js";async function C(c){return h({url:"/api/v1/server/info/"+c,method:"get"})}async function F(c,r=1){return h({url:`/api/v1/server/statistics/${c}?type=${r}`,method:"get"})}const N={computed:{help(){return P}},components:{MonitorFaults:E,ServerStatisticsBar:v},data(){return{settingStore:w(),total:[],server:null,serverId:null,serverStatisticsType:3,colors:[{color:"#5cb87a",percentage:50},{color:"#e6a23c",percentage:80},{color:"#f56c6c",percentage:100}],ws:null}},watch:{"$route.params.id"(){this.serverId=this.$route.params.id,this.getServerInfo(this.serverId),this.getServerStatisticsList(this.serverId),this.$bus.emit("serverSelect",this.serverId)}},mounted(){this.serverId=this.$route.params.id,this.getServerInfo(this.serverId),this.getServerStatisticsList(this.serverId),this.$bus.emit("serverSelect",this.serverId),this.registerServerListen()},unmounted(){if(this.$bus.emit("serverSelect",null),this.ws){let c=this.ws;this.ws=null,c.close()}},methods:{getServerInfo(c){C(c).then(r=>{this.server=r})},getServerStatisticsList(c){F(c,this.serverStatisticsType).then(r=>{this.total=r})},registerServerListen(){this.ws=new WebSocket("/ws/web"),this.ws.addEventListener("message",c=>{let r=JSON.parse(c.data),i=JSON.parse(r.message);console.log("Message from server ",r.message_type,i),r.message_type===5e3?i.server_id==this.serverId&&(this.server.status=1,this.server.server_info=i.server_info,this.server.server_state=i.server_state):r.message_type===5001?i==this.serverId&&(this.server.status=0):r.message_type===5002&&i.server_id==this.serverId&&(console.log("Server state update: ",i),this.server.server_state=i)}),this.ws.addEventListener("close",c=>{console.log("Server connection closed: ",c),this.ws!=null&&(this.$message({type:"error",message:"服务器连接已断开，正在重新链接!"}),setTimeout(()=>{this.registerServerListen()},1e3))})},goHome(){this.$router.push("/")}}},o=c=>(z("data-v-4fce942d"),c=c(),B(),c),T={key:0,class:"container mt-3"},H={class:"mb-3"},V={class:"server"},D={class:"shadow-box mb-3"},J={class:"row"},M={class:"col-md-8"},U={class:"wrap",style:{padding:"7.5px 2.6px",width:"100%"}},q=o(()=>s("span",{class:"desc"},"最近30天",-1)),O={class:"col-md-4 text-center"},j={key:0,class:"badge rounded-pill bg-primary",style:{"font-size":"30px"}},K={key:1,class:"badge rounded-pill bg-danger",style:{"font-size":"30px"}},W={class:"shadow-box big-padding text-center stats mb-3"},A={class:"row"},G={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},Q=o(()=>s("h4",{class:"col-4 col-sm-12"},"系统",-1)),R=o(()=>s("p",{class:"col-4 col-sm-12 mb-0 mb-sm-2"}," os ",-1)),X={class:"col-4 col-sm-12 num"},Y={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},Z=o(()=>s("h4",{class:"col-4 col-sm-12"},"系统型号",-1)),$=o(()=>s("p",{class:"col-4 col-sm-12 mb-0 mb-sm-2"}," platform ",-1)),ss={class:"col-4 col-sm-12 num"},es={class:"shadow-box big-padding text-center stats mb-3"},os={class:"row"},ts={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},cs=o(()=>s("h4",{class:"col-4 col-sm-12"},"CPU型号",-1)),ls=o(()=>s("p",{class:"col-4 col-sm-12 mb-0 mb-sm-2"}," cpu ",-1)),rs={class:"col-4 col-sm-12 num"},is={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},ns=o(()=>s("h4",{class:"col-4 col-sm-12"},"虚拟化",-1)),_s=o(()=>s("p",{class:"col-4 col-sm-12 mb-0 mb-sm-2"}," virtualization ",-1)),ds={class:"col-4 col-sm-12 num"},as={class:""},ms={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},hs=o(()=>s("h4",{class:"col-4 col-sm-12"},"最后在线时间",-1)),vs=o(()=>s("p",{class:"col-4 col-sm-12 mb-0 mb-sm-2"}," Last online ",-1)),ps={class:"col-4 col-sm-12 num"},fs={class:""},us={class:"row"},gs={class:"col-md-6"},bs={class:"shadow-box mb-3"},ws={style:{display:"flex","justify-content":"space-between"}},xs=o(()=>s("h4",{class:"mb-3"},"CPU Load",-1)),Ss={class:"desc"},ys={class:"text-center mb-5"},ks={class:"row mb-3"},Is={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},zs=o(()=>s("div",{class:"col-6 col-sm-12"},"Load1",-1)),Bs={class:"col-6 col-sm-12 num desc"},Ls={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},Ps=o(()=>s("div",{class:"col-6 col-sm-12"},"Load5",-1)),Es={class:"col-6 col-sm-12 num desc"},Cs={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},Fs=o(()=>s("div",{class:"col-6 col-sm-12"},"Load15",-1)),Ns={class:"col-6 col-sm-12 num desc"},Ts={class:"row"},Hs={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},Vs=o(()=>s("div",{class:"col-6 col-sm-12"},"TCP连接数",-1)),Ds={class:"col-6 col-sm-12 num desc"},Js={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},Ms=o(()=>s("div",{class:"col-6 col-sm-12"},"UDP连接数",-1)),Us={class:"col-6 col-sm-12 num desc"},qs={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},Os=o(()=>s("div",{class:"col-6 col-sm-12"},"进程数",-1)),js={class:"col-6 col-sm-12 num desc"},Ks={class:"col-md-6"},Ws={class:"shadow-box mb-3"},As=o(()=>s("h4",{class:"mb-3"},"内存",-1)),Gs={class:"mb-3"},Qs={class:"row"},Rs={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},Xs=o(()=>s("div",{class:"col-6 col-sm-12"},"内存大小",-1)),Ys={class:"col-6 col-sm-12 num desc"},Zs={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},$s=o(()=>s("div",{class:"col-6 col-sm-12"},"内存占用",-1)),se={class:"col-6 col-sm-12 num desc"},ee={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},oe=o(()=>s("div",{class:"col-6 col-sm-12"},"交换分区大小",-1)),te={class:"col-6 col-sm-12 num desc"},ce={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},le=o(()=>s("div",{class:"col-6 col-sm-12"},"交换分区占用",-1)),re={class:"col-6 col-sm-12 num desc"},ie={class:"shadow-box mb-3"},ne=o(()=>s("h4",{class:"mb-3"},"磁盘",-1)),_e={class:"mb-3"},de={class:"shadow-box mb-3"},ae=o(()=>s("h4",{class:"mb-3"},"网络",-1)),me={class:"row"},he={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},ve=o(()=>s("div",{class:"col-6 col-sm-12"},"入站速度",-1)),pe={class:"col-6 col-sm-12 desc"},fe={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},ue=o(()=>s("div",{class:"col-6 col-sm-12"},"出站速度",-1)),ge={class:"col-6 col-sm-12 desc"},be={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},we=o(()=>s("div",{class:"col-6 col-sm-12"},"入站流量",-1)),xe={class:"col-6 col-sm-12 desc"},Se={class:"col-12 col-sm col row d-flex align-items-center d-sm-block"},ye=o(()=>s("div",{class:"col-6 col-sm-12"},"出站流量",-1)),ke={class:"col-6 col-sm-12 desc"},Ie={key:1,class:"shadow-box"};function ze(c,r,i,Be,e,l){const p=v,f=k,a=I,u=L;return e.server?(_(),d("div",T,[s("h1",H,[s("button",{class:"btn btn-primary",onClick:r[0]||(r[0]=(...g)=>l.goHome&&l.goHome(...g))},"返回"),m(" 状态速览 - "+t(e.server.name),1)]),s("div",V,[e.server.server_info?(_(),d(x,{key:0},[s("div",D,[s("div",J,[s("div",M,[s("div",U,[n(p,{width:10,height:30,total:e.total},null,8,["total"])]),q]),s("div",O,[e.server.status===1?(_(),d("span",j," 在线 ")):(_(),d("span",K," 离线 "))])])]),s("div",W,[s("div",A,[s("div",G,[Q,R,s("span",X,t(e.server.server_info.os),1)]),s("div",Y,[Z,$,s("span",ss,t(e.server.server_info.platform),1)])])]),s("div",es,[s("div",os,[s("div",ts,[cs,ls,s("span",rs,[n(f,{"line-clamp":"1",title:e.server.server_info.cpu},{default:S(()=>[m(t(e.server.server_info.cpu),1)]),_:1},8,["title"])])]),s("div",is,[ns,_s,s("span",ds,[s("span",as,t(e.server.server_info.virtualization),1)])]),s("div",ms,[hs,vs,s("span",ps,[s("span",fs,t(e.server.last_online_time),1)])])])]),s("div",us,[s("div",gs,[s("div",bs,[s("div",ws,[xs,s("span",Ss,"最后更新于："+t(e.server.server_state.update_time),1)]),s("div",ys,[n(a,{type:"dashboard","stroke-width":20,width:200,striped:"","striped-flow":"",percentage:l.help.formatPercent(100,e.server.server_state.cpu),color:e.colors},null,8,["percentage","color"])]),s("div",ks,[s("div",Is,[zs,s("span",Bs,t(e.server.server_state.load1.toFixed(2)),1)]),s("div",Ls,[Ps,s("span",Es,t(e.server.server_state.load5.toFixed(2)),1)]),s("div",Cs,[Fs,s("span",Ns,t(e.server.server_state.load15.toFixed(2)),1)])]),s("div",Ts,[s("div",Hs,[Vs,s("span",Ds,t(e.server.server_state.tcp_conn_count),1)]),s("div",Js,[Ms,s("span",Us,t(e.server.server_state.udp_conn_count),1)]),s("div",qs,[Os,s("span",js,t(e.server.server_state.process_count),1)])])])]),s("div",Ks,[s("div",Ws,[As,s("div",Gs,[n(a,{percentage:l.help.formatPercent(e.server.server_info.mem_total,e.server.server_state.mem_used),color:e.colors,striped:"","striped-flow":""},null,8,["percentage","color"])]),s("div",Qs,[s("div",Rs,[Xs,s("span",Ys,t(l.help.formatByteSize(e.server.server_info.mem_total)),1)]),s("div",Zs,[$s,s("span",se,t(l.help.formatByteSize(e.server.server_state.mem_used)),1)]),s("div",ee,[oe,s("span",te,t(l.help.formatByteSize(e.server.server_info.swap_total)),1)]),s("div",ce,[le,s("span",re,t(l.help.formatByteSize(e.server.server_state.swap_used)),1)])])]),s("div",ie,[ne,s("div",_e,[n(a,{percentage:l.help.formatPercent(e.server.server_info.disk_total,e.server.server_state.disk_used),format:()=>l.help.formatByteSize(e.server.server_state.disk_used)+"/"+l.help.formatByteSize(e.server.server_info.disk_total),color:e.colors,striped:"","striped-flow":""},null,8,["percentage","format","color"])])]),s("div",de,[ae,s("div",me,[s("div",he,[ve,s("span",pe,t(l.help.formatByteSize(e.server.server_state.net_in_speed))+"/s ",1)]),s("div",fe,[ue,s("span",ge,t(l.help.formatByteSize(e.server.server_state.net_out_speed))+"/s ",1)]),s("div",be,[we,s("span",xe,t(l.help.formatByteSize(e.server.server_state.net_in_transfer)),1)]),s("div",Se,[ye,s("span",ke,t(l.help.formatByteSize(e.server.server_state.net_out_transfer)),1)])])])])])],64)):(_(),d("div",Ie,[n(u,{description:"无数据"})]))])])):y("",!0)}const Te=b(N,[["render",ze],["__scopeId","data-v-4fce942d"]]);export{Te as default};
